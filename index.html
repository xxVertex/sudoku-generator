<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }

        .app-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9em;
        }

        .difficulty-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .difficulty-btn {
            padding: 10px 20px;
            font-size: 14px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .difficulty-btn:hover {
            background: #f0f0f0;
        }

        .difficulty-btn.active {
            background: #667eea;
            color: white;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        #notes-toggle {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        #notes-toggle.active {
            background: #667eea;
            color: white;
        }

        #notes-toggle:hover {
            background: #f0f0f0;
        }

        #notes-toggle.active:hover {
            background: #5568d3;
        }

        .game-layout {
            display: flex;
            gap: 40px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            grid-template-rows: repeat(9, 1fr);
            gap: 1px;
            width: 450px;
            height: 450px;
            background-color: #333;
            border: 3px solid #333;
        }

        .cell {
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
            position: relative;
        }

        .cell .main-number {
            font-size: 24px;
            font-weight: bold;
        }

        .cell .notes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            padding: 2px;
        }

        .cell .note {
            font-size: 10px;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cell:hover:not(.given) {
            background-color: #e3f2fd;
        }

        .cell.given {
            background-color: #f5f5f5;
            color: #333;
            cursor: default;
        }

        .cell.user-input {
            color: #667eea;
        }

        .cell.selected {
            background-color: #bbdefb !important;
        }

        .cell.error {
            background-color: #ffcdd2 !important;
            color: #c62828;
        }

        /* Thicker borders for 3x3 boxes */
        .cell:nth-child(3n) {
            border-right: 2px solid #333;
        }

        .cell:nth-child(n+19):nth-child(-n+27),
        .cell:nth-child(n+46):nth-child(-n+54) {
            border-bottom: 2px solid #333;
        }

        .number-pad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 200px;
        }

        .num-btn {
            padding: 15px;
            font-size: 20px;
            font-weight: bold;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .num-btn:hover {
            background: #667eea;
            color: white;
            transform: scale(1.05);
        }

        .num-btn:active {
            transform: scale(0.95);
        }

        .num-btn.erase {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .num-btn.erase:hover {
            background: #d32f2f;
        }

        .message {
            text-align: center;
            margin-top: 20px;
            font-size: 1.1em;
            min-height: 30px;
            font-weight: bold;
        }

        .message.success {
            color: #4caf50;
        }

        .message.error {
            color: #f44336;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <h1>üéØ Sudoku</h1>
        <p class="subtitle">Click on a cell and type a number (1-9)</p>
        
        <div class="difficulty-selector">
            <button class="difficulty-btn" data-difficulty="easy">Easy</button>
            <button class="difficulty-btn active" data-difficulty="medium">Medium</button>
            <button class="difficulty-btn" data-difficulty="hard">Hard</button>
        </div>

        <div class="controls">
            <button id="new-game">New Puzzle</button>
            <button id="notes-toggle">üìù Notes</button>
            <button id="check">Check</button>
        </div>

        <div class="game-layout">
            <div class="grid-container" id="sudoku-grid"></div>
            
            <div class="number-pad">
                <button class="num-btn" data-number="1">1</button>
                <button class="num-btn" data-number="2">2</button>
                <button class="num-btn" data-number="3">3</button>
                <button class="num-btn" data-number="4">4</button>
                <button class="num-btn" data-number="5">5</button>
                <button class="num-btn" data-number="6">6</button>
                <button class="num-btn" data-number="7">7</button>
                <button class="num-btn" data-number="8">8</button>
                <button class="num-btn" data-number="9">9</button>
            </div>
        </div>
        
        <div class="message" id="message"></div>
    </div>

    <script>
        const container = document.getElementById('sudoku-grid');
        const messageEl = document.getElementById('message');
        let cells = [];
        let selectedCell = null;
        let board = Array(9).fill(null).map(() => Array(9).fill(0));
        let solution = Array(9).fill(null).map(() => Array(9).fill(0));
        let notes = Array(9).fill(null).map(() => Array(9).fill(null).map(() => new Set()));
        let currentDifficulty = 'medium';
        let notesMode = false;

        // Generate 81 cells
        for (let i = 0; i < 81; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset.index = i;
            cell.addEventListener('click', () => selectCell(cell));
            
            // Add notes grid structure
            const notesGrid = document.createElement('div');
            notesGrid.className = 'notes-grid';
            for (let j = 1; j <= 9; j++) {
                const noteSpan = document.createElement('span');
                noteSpan.className = 'note';
                noteSpan.dataset.number = j;
                notesGrid.appendChild(noteSpan);
            }
            cell.appendChild(notesGrid);
            
            // Add main number display
            const mainNumber = document.createElement('div');
            mainNumber.className = 'main-number';
            cell.appendChild(mainNumber);
            
            container.appendChild(cell);
            cells.push(cell);
        }

        // Difficulty selector
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentDifficulty = btn.dataset.difficulty;
            });
        });

        function updateCellDisplay(cell, idx) {
            const row = Math.floor(idx / 9);
            const col = idx % 9;
            const mainNumber = cell.querySelector('.main-number');
            const notesGrid = cell.querySelector('.notes-grid');
            
            if (board[row][col] !== 0) {
                // Show main number
                mainNumber.textContent = board[row][col];
                mainNumber.style.display = 'block';
                notesGrid.style.display = 'none';
            } else {
                // Show notes
                mainNumber.style.display = 'none';
                notesGrid.style.display = 'grid';
                
                // Update each note position
                notesGrid.querySelectorAll('.note').forEach(noteSpan => {
                    const num = parseInt(noteSpan.dataset.number);
                    noteSpan.textContent = notes[row][col].has(num) ? num : '';
                });
            }
        }

        // Number pad
        document.querySelectorAll('.num-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (!selectedCell || selectedCell.classList.contains('given')) {
                    messageEl.textContent = '‚ö†Ô∏è Select an empty cell first!';
                    messageEl.className = 'message error';
                    return;
                }
                
                const num = parseInt(btn.dataset.number);
                const idx = parseInt(selectedCell.dataset.index);
                const row = Math.floor(idx / 9);
                const col = idx % 9;
                
                if (notesMode) {
                    // Toggle note
                    if (notes[row][col].has(num)) {
                        notes[row][col].delete(num);
                    } else {
                        notes[row][col].add(num);
                    }
                    updateCellDisplay(selectedCell, idx);
                } else {
                    // Set main number and clear notes
                    selectedCell.classList.add('user-input');
                    selectedCell.classList.remove('error');
                    board[row][col] = num;
                    notes[row][col].clear();
                    updateCellDisplay(selectedCell, idx);
                }
                messageEl.textContent = '';
            });
        });

        function selectCell(cell) {
            if (cell.classList.contains('given')) return;
            
            if (selectedCell) {
                selectedCell.classList.remove('selected');
            }
            
            selectedCell = cell;
            cell.classList.add('selected');
        }

        // Handle keyboard input
        document.addEventListener('keydown', (e) => {
            if (!selectedCell) return;
            
            const idx = parseInt(selectedCell.dataset.index);
            const row = Math.floor(idx / 9);
            const col = idx % 9;

            // Arrow key navigation
            if (e.key === 'ArrowUp' && row > 0) {
                selectCell(cells[idx - 9]);
                e.preventDefault();
            } else if (e.key === 'ArrowDown' && row < 8) {
                selectCell(cells[idx + 9]);
                e.preventDefault();
            } else if (e.key === 'ArrowLeft' && col > 0) {
                selectCell(cells[idx - 1]);
                e.preventDefault();
            } else if (e.key === 'ArrowRight' && col < 8) {
                selectCell(cells[idx + 1]);
                e.preventDefault();
            }
            
            // Number input for non-given cells
            if (selectedCell.classList.contains('given')) return;

            if (e.key >= '1' && e.key <= '9') {
                const num = parseInt(e.key);
                selectedCell.textContent = e.key;
                selectedCell.classList.add('user-input');
                selectedCell.classList.remove('error');
                board[row][col] = num;
                messageEl.textContent = '';
            } else if (e.key === 'Backspace' || e.key === 'Delete' || e.key === '0') {
                selectedCell.textContent = '';
                selectedCell.classList.remove('user-input', 'error');
                board[row][col] = 0;
            }
        });

        // Check if number is valid in position
        function isValid(board, row, col, num) {
            // Check row
            for (let x = 0; x < 9; x++) {
                if (board[row][x] === num) return false;
            }
            
            // Check column
            for (let x = 0; x < 9; x++) {
                if (board[x][col] === num) return false;
            }
            
            // Check 3x3 box
            const startRow = row - row % 3;
            const startCol = col - col % 3;
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    if (board[i + startRow][j + startCol] === num) return false;
                }
            }
            
            return true;
        }

        // Solve sudoku using backtracking
        function solveSudoku(board) {
            for (let row = 0; row < 9; row++) {
                for (let col = 0; col < 9; col++) {
                    if (board[row][col] === 0) {
                        for (let num = 1; num <= 9; num++) {
                            if (isValid(board, row, col, num)) {
                                board[row][col] = num;
                                if (solveSudoku(board)) return true;
                                board[row][col] = 0;
                            }
                        }
                        return false;
                    }
                }
            }
            return true;
        }

        // Generate a complete valid sudoku board
        function generateCompleteBoard() {
            const board = Array(9).fill(null).map(() => Array(9).fill(0));
            fillBoard(board);
            return board;
        }

        function fillBoard(board) {
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9];
            
            for (let row = 0; row < 9; row++) {
                for (let col = 0; col < 9; col++) {
                    if (board[row][col] === 0) {
                        // Shuffle numbers for randomness
                        numbers.sort(() => Math.random() - 0.5);
                        
                        for (let num of numbers) {
                            if (isValid(board, row, col, num)) {
                                board[row][col] = num;
                                if (fillBoard(board)) return true;
                                board[row][col] = 0;
                            }
                        }
                        return false;
                    }
                }
            }
            return true;
        }

        // Generate puzzle by removing numbers
        function generatePuzzle(difficulty) {
            const completeBoard = generateCompleteBoard();
            solution = completeBoard.map(row => [...row]);
            
            const puzzle = completeBoard.map(row => [...row]);
            
            // Determine how many cells to remove based on difficulty
            const cellsToRemove = {
                easy: 35,
                medium: 45,
                hard: 55
            }[difficulty];
            
            let removed = 0;
            while (removed < cellsToRemove) {
                const row = Math.floor(Math.random() * 9);
                const col = Math.floor(Math.random() * 9);
                
                if (puzzle[row][col] !== 0) {
                    puzzle[row][col] = 0;
                    removed++;
                }
            }
            
            return puzzle;
        }

        // Display board on grid
        function displayBoard(board, isInitial = false) {
            cells.forEach((cell, idx) => {
                const row = Math.floor(idx / 9);
                const col = idx % 9;
                const value = board[row][col];
                
                cell.textContent = value || '';
                cell.classList.remove('given', 'user-input', 'selected', 'error');
                
                if (value && isInitial) {
                    cell.classList.add('given');
                }
            });
            selectedCell = null;
        }

        // New game
        document.getElementById('new-game').addEventListener('click', () => {
            board = generatePuzzle(currentDifficulty);
            displayBoard(board, true);
            messageEl.textContent = '‚ú® New puzzle generated!';
            messageEl.className = 'message success';
        });

        // Check solution
        document.getElementById('check').addEventListener('click', () => {
            let hasEmpty = false;
            let hasErrors = false;
            
            cells.forEach((cell, idx) => {
                const row = Math.floor(idx / 9);
                const col = idx % 9;
                
                cell.classList.remove('error');
                
                if (board[row][col] === 0) {
                    hasEmpty = true;
                } else if (board[row][col] !== solution[row][col]) {
                    hasErrors = true;
                    if (!cell.classList.contains('given')) {
                        cell.classList.add('error');
                    }
                }
            });
            
            if (hasEmpty) {
                messageEl.textContent = '‚ö†Ô∏è Puzzle not complete yet!';
                messageEl.className = 'message error';
            } else if (hasErrors) {
                messageEl.textContent = '‚ùå There are some mistakes!';
                messageEl.className = 'message error';
            } else {
                messageEl.textContent = 'üéâ Perfect! You solved it!';
                messageEl.className = 'message success';
            }
        });

        // Generate initial puzzle
        board = generatePuzzle('medium');
        displayBoard(board, true);
    </script>
</body>
</html>

<!--
TO DO:
    - Fix arrow navigation:
        When moving trough cells with the arrow keys across over an arrow that is given it doesn't go past, but it goes past when navigating through the
        empty or written by me cells.
    - Fix notes functionality:
        When I click on a cell to write a note, it doesn't write the note in the cell.

ADD:
    - Row and column highlight when a cell is selected.
    - 
-->